import importlib

from .cv2 import *
from .data import *

# wildcard import above does not import "private" variables like __version__
# this makes them available
globals().update(importlib.import_module('cv2.cv2').__dict__)


def imshow_image(title, image):
    from PIL import Image
    from scipy import ndimage
    from pyto import QuickLookHelper
    from io import BytesIO
    import base64
    
    image = Image.fromarray(ndimage.rotate(image, QuickLookHelper.openCvRotation))
    buffered = BytesIO()
    image.save(buffered, format="JPEG")
    img_str = base64.b64encode(buffered.getvalue()).decode("utf-8")
    
    try:
        QuickLookHelper.previewFile(img_str, script=threading.current_thread().script_path, removePrevious=True)
    except:
        QuickLookHelper.previewFile(img_str, script=None, removePrevious=True)
    
imshow = imshow_image
